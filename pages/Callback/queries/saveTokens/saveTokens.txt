INSERT INTO public.credenciais_clientes
  (client_id, app_id, conn_label, title, access_token, refresh_token, "CODIGO_AUTORIZACAO")
VALUES
  (
    {{ this.params.client_id }},
    {{ this.params.app_id }},
    {{ this.params.conn_label }},
    {{ "'CA:" + this.params.client_id + ":" + this.params.app_id + ":" + this.params.conn_label }},
    {{ CA_Token.data.access_token }},
    {{ CA_Token.data.refresh_token }},
    {{ this.params.code }}
  )
ON CONFLICT (client_id, app_id, conn_label)
DO UPDATE SET
  access_token         = EXCLUDED.access_token,
  refresh_token        = EXCLUDED.refresh_token,
  "CODIGO_AUTORIZACAO" = EXCLUDED."CODIGO_AUTORIZACAO"
RETURNING id;

